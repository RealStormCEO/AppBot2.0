(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43,152],{72171:function(e,r,n){Promise.resolve().then(n.bind(n,43403))},47907:function(e,r,n){"use strict";var a=n(15313);n.o(a,"useParams")&&n.d(r,{useParams:function(){return a.useParams}}),n.o(a,"usePathname")&&n.d(r,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(r,{useRouter:function(){return a.useRouter}})},43403:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return s}});var a=n(57437),t=n(71126);n(91259);var o=n(43152);function s(e){let{children:r}=e;return(0,a.jsx)("html",{lang:"en",children:(0,a.jsx)("body",{children:(0,a.jsxs)(t.SessionProvider,{children:[(0,a.jsx)(o.default,{}),r]})})})}},43152:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return u}});var a=n(57437),t=n(71126),o=n(2265),s=n(47907),l=n(83041),i=n.n(l);function u(){var e,r,n,l;let{data:u,status:d}=(0,t.useSession)(),c=(0,s.useRouter)(),v=(0,s.usePathname)(),[h,p]=(0,o.useState)(!1),[f,m]=(0,o.useState)(!1),[_,g]=(0,o.useState)(!1),[x,j]=(0,o.useState)(""),[b,D]=(0,o.useState)(null),[N,w]=(0,o.useState)([]),[T,k]=(0,o.useState)(""),S=(0,o.useRef)(null),E=null==v?void 0:v.startsWith("/developer"),P=(()=>{let e=null==v?void 0:v.split("/");if(!e||e.length<3)return null;let[r,n,a]=e;return["dashboard","applications","settings"].includes(n)&&/^\d+$/.test(a)?a:null})();if((0,o.useEffect)(()=>{let e=e=>{S.current&&!S.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,o.useEffect)(()=>{(async()=>{var e;if(!(null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.id)){g(!0);return}try{let e=await fetch("/api/is-dev-user?userId=".concat(u.user.id)),r=await e.json();m(r.isDev||!1)}catch(e){console.error("\uD83D\uDD25 Failed to check dev access:",e)}finally{g(!0)}})()},[null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.id]),(0,o.useEffect)(()=>{(async()=>{if(!P){""!==x&&j("");return}if("authenticated"===d&&(null==u?void 0:u.accessToken))try{let e=await fetch("https://discord.com/api/users/@me/guilds",{headers:{Authorization:"Bearer ".concat(u.accessToken)}}),r=(await e.json()).find(e=>e.id===P);r&&j(r.name)}catch(e){console.error("⚠️ Failed to fetch guild name:",e)}})()},[P,null==u?void 0:u.accessToken,d]),(0,o.useEffect)(()=>{(async function(){var e;if(null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.id)try{let e=await fetch("/api/developer/current-user"),r=e.ok?await e.json():null;D(r);let n=await fetch("/api/developer/plans"),a=n.ok?await n.json():[];w(a)}catch(e){console.error("Failed to fetch user or plans:",e)}})()},[null==u?void 0:null===(r=u.user)||void 0===r?void 0:r.id]),(0,o.useEffect)(()=>{if(!(null==b?void 0:b.expiration_date)){k("");return}function e(){let e=new Date,r=new Date(b.expiration_date)-e;if(r<=0){k("Expired");return}let n=Math.floor(r/31536e6),a=Math.floor((r-=31536e6*n)/864e5),t=Math.floor((r-=864e5*a)/36e5),o=Math.floor((r-=36e5*t)/6e4),s=[];n>0&&s.push("".concat(n,"y")),a>0&&s.push("".concat(a,"d")),t>0&&s.push("".concat(t,"h")),s.push("".concat(o,"m")),k(s.join(", "))}e();let r=setInterval(e,6e4);return()=>clearInterval(r)},[null==b?void 0:b.expiration_date]),"loading"===d)return null;let B=x?"Editing Server: ".concat(x):"",y=((null==b?void 0:b.plan)||"Free").trim().toLowerCase(),I=N.find(e=>e.name.trim().toLowerCase()===y);return(0,a.jsxs)("div",{className:i().topbar,children:[(0,a.jsxs)("div",{className:i().logoArea,children:[(0,a.jsx)("img",{src:"/default-icon.jpg",alt:"AppBot Logo",className:i().logoImage}),(0,a.jsx)("span",{className:i().brand,children:"AppBot2.0"})]}),(E||B)&&(0,a.jsx)("div",{className:i().centerText,children:(0,a.jsx)("span",{className:i().guildName,children:E?"Developer Panel":B})}),(0,a.jsxs)("div",{className:i().right,children:[(null==u?void 0:u.user)&&(0,a.jsx)("div",{className:i().avatarWrapper,onClick:()=>p(e=>!e),children:(0,a.jsx)("img",{src:u.user.image,alt:"Profile",className:i().avatar})}),(null==u?void 0:u.user)&&h&&(0,a.jsxs)("div",{className:i().dropdown,ref:S,children:[(0,a.jsxs)("div",{className:i().userInfoDropdown,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"User:"})," ",(null==b?void 0:b.username)||u.user.name]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Plan:"})," ",(null==I?void 0:I.name)||(null==b?void 0:b.plan)||"Free"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Max Forms:"})," ",null!==(n=null==I?void 0:I.max_forms)&&void 0!==n?n:"N/A"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Max Questions:"})," ",null!==(l=null==I?void 0:I.max_questions)&&void 0!==l?l:"N/A"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Time Remaining:"}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{children:T||"N/A"})]})]}),(0,a.jsx)("a",{href:"https://discord.gg/svHdVh2Bff",target:"_blank",rel:"noopener noreferrer",className:i().devButton,style:{textAlign:"center"},children:"\uD83D\uDD17 Join Support Server"}),"/servers"!==v&&(0,a.jsx)("button",{className:i().devButton,onClick:()=>c.push("/servers"),children:"\uD83D\uDD01 Switch Servers"}),f&&(0,a.jsx)("button",{className:i().devButton,onClick:()=>c.push("/developer/dashboard"),children:"\uD83D\uDEE0 Developer Panel"}),(0,a.jsx)("button",{className:i().logout,onClick:()=>(0,t.signOut)({callbackUrl:"/home"}),children:"\uD83D\uDCD5 Log out"})]})]})]})}},91259:function(){},83041:function(e){e.exports={topbar:"Topbar_topbar__V0QGl",right:"Topbar_right__Jj2ao",logoArea:"Topbar_logoArea__forZL",logoImage:"Topbar_logoImage__LJuRd",brand:"Topbar_brand__3hSuU",avatarWrapper:"Topbar_avatarWrapper__5Bf2P",avatar:"Topbar_avatar__Eq_S3",dropdown:"Topbar_dropdown__HJUG8",fadeIn:"Topbar_fadeIn__o0Bh1",name:"Topbar_name__eFLUk",logout:"Topbar_logout__u1BV7",devButton:"Topbar_devButton__28Bss",centerText:"Topbar_centerText__7McvY",guildName:"Topbar_guildName__av6yP",userInfoDropdown:"Topbar_userInfoDropdown__dVogq"}}},function(e){e.O(0,[126,971,69,744],function(){return e(e.s=72171)}),_N_E=e.O()}]);